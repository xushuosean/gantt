!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Gantt=e()}(this,(function(){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}"function"==typeof SuppressedError&&SuppressedError;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var r={exports:{}};!function(t,e){t.exports=function(){var t=1e3,e=6e4,n=36e5,r="millisecond",i="second",o="minute",s="hour",a="day",u="week",h="month",c="quarter",d="year",l="date",p="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},v=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},m={s:v,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+v(r,2,"0")+":"+v(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,h),o=n-i<0,s=e.clone().add(r+(o?-1:1),h);return+(-(r+(n-i)/(o?i-s:s-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:h,y:d,w:u,d:a,D:l,h:s,m:o,s:i,ms:r,Q:c}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},w="en",b={};b[w]=y;var S=function(t){return t instanceof H},M=function t(e,n,r){var i;if(!e)return w;if("string"==typeof e){var o=e.toLowerCase();b[o]&&(i=o),n&&(b[o]=n,i=o);var s=e.split("-");if(!i&&s.length>1)return t(s[0])}else{var a=e.name;b[a]=e,i=a}return!r&&i&&(w=i),i||!r&&w},E=function(t,e){if(S(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new H(n)},$=m;$.l=M,$.i=S,$.w=function(t,e){return E(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var H=function(){function y(t){this.$L=M(t.locale,null,!0),this.parse(t)}var v=y.prototype;return v.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if($.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(f);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},v.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},v.$utils=function(){return $},v.isValid=function(){return!(this.$d.toString()===p)},v.isSame=function(t,e){var n=E(t);return this.startOf(e)<=n&&n<=this.endOf(e)},v.isAfter=function(t,e){return E(t)<this.startOf(e)},v.isBefore=function(t,e){return this.endOf(e)<E(t)},v.$g=function(t,e,n){return $.u(t)?this[e]:this.set(n,t)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(t,e){var n=this,r=!!$.u(e)||e,c=$.p(t),p=function(t,e){var i=$.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},f=function(t,e){return $.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},g=this.$W,y=this.$M,v=this.$D,m="set"+(this.$u?"UTC":"");switch(c){case d:return r?p(1,0):p(31,11);case h:return r?p(1,y):p(0,y+1);case u:var w=this.$locale().weekStart||0,b=(g<w?g+7:g)-w;return p(r?v-b:v+(6-b),y);case a:case l:return f(m+"Hours",0);case s:return f(m+"Minutes",1);case o:return f(m+"Seconds",2);case i:return f(m+"Milliseconds",3);default:return this.clone()}},v.endOf=function(t){return this.startOf(t,!1)},v.$set=function(t,e){var n,u=$.p(t),c="set"+(this.$u?"UTC":""),p=(n={},n[a]=c+"Date",n[l]=c+"Date",n[h]=c+"Month",n[d]=c+"FullYear",n[s]=c+"Hours",n[o]=c+"Minutes",n[i]=c+"Seconds",n[r]=c+"Milliseconds",n)[u],f=u===a?this.$D+(e-this.$W):e;if(u===h||u===d){var g=this.clone().set(l,1);g.$d[p](f),g.init(),this.$d=g.set(l,Math.min(this.$D,g.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},v.set=function(t,e){return this.clone().$set(t,e)},v.get=function(t){return this[$.p(t)]()},v.add=function(r,c){var l,p=this;r=Number(r);var f=$.p(c),g=function(t){var e=E(p);return $.w(e.date(e.date()+Math.round(t*r)),p)};if(f===h)return this.set(h,this.$M+r);if(f===d)return this.set(d,this.$y+r);if(f===a)return g(1);if(f===u)return g(7);var y=(l={},l[o]=e,l[s]=n,l[i]=t,l)[f]||1,v=this.$d.getTime()+r*y;return $.w(v,this)},v.subtract=function(t,e){return this.add(-1*t,e)},v.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=$.z(this),o=this.$H,s=this.$m,a=this.$M,u=n.weekdays,h=n.months,c=n.meridiem,d=function(t,n,i,o){return t&&(t[n]||t(e,r))||i[n].slice(0,o)},l=function(t){return $.s(o%12||12,t,"0")},f=c||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(g,(function(t,r){return r||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return $.s(e.$y,4,"0");case"M":return a+1;case"MM":return $.s(a+1,2,"0");case"MMM":return d(n.monthsShort,a,h,3);case"MMMM":return d(h,a);case"D":return e.$D;case"DD":return $.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return d(n.weekdaysMin,e.$W,u,2);case"ddd":return d(n.weekdaysShort,e.$W,u,3);case"dddd":return u[e.$W];case"H":return String(o);case"HH":return $.s(o,2,"0");case"h":return l(1);case"hh":return l(2);case"a":return f(o,s,!0);case"A":return f(o,s,!1);case"m":return String(s);case"mm":return $.s(s,2,"0");case"s":return String(e.$s);case"ss":return $.s(e.$s,2,"0");case"SSS":return $.s(e.$ms,3,"0");case"Z":return i}return null}(t)||i.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,l,p){var f,g=this,y=$.p(l),v=E(r),m=(v.utcOffset()-this.utcOffset())*e,w=this-v,b=function(){return $.m(g,v)};switch(y){case d:f=b()/12;break;case h:f=b();break;case c:f=b()/3;break;case u:f=(w-m)/6048e5;break;case a:f=(w-m)/864e5;break;case s:f=w/n;break;case o:f=w/e;break;case i:f=w/t;break;default:f=w}return p?f:$.a(f)},v.daysInMonth=function(){return this.endOf(h).$D},v.$locale=function(){return b[this.$L]},v.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=M(t,e,!0);return r&&(n.$L=r),n},v.clone=function(){return $.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},y}(),O=H.prototype;return E.prototype=O,[["$ms",r],["$s",i],["$m",o],["$H",s],["$W",a],["$M",h],["$y",d],["$D",l]].forEach((function(t){O[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),E.extend=function(t,e){return t.$i||(t(e,H,E),t.$i=!0),E},E.locale=M,E.isDayjs=S,E.unix=function(t){return E(1e3*t)},E.en=b[w],E.Ls=b,E.p={},E}()}(r);var i=n(r.exports),o={exports:{}};!function(t,e){t.exports=function(t,e,n){var r=function(t,e){if(!e||!e.length||1===e.length&&!e[0]||1===e.length&&Array.isArray(e[0])&&!e[0].length)return null;var n;1===e.length&&e[0].length>0&&(e=e[0]),n=(e=e.filter((function(t){return t})))[0];for(var r=1;r<e.length;r+=1)e[r].isValid()&&!e[r][t](n)||(n=e[r]);return n};n.max=function(){var t=[].slice.call(arguments,0);return r("isAfter",t)},n.min=function(){var t=[].slice.call(arguments,0);return r("isBefore",t)}}}(o);var s=n(o.exports);i.extend(s);var a=function(){function t(t,e,n){this.datas=[],this.gantt=t,this.tasks=e,this.options=n,this.init()}return t.prototype.init=function(){this.setupDate(),this.convertToCell()},t.prototype.getMinMaxDate=function(){var t=i(this.tasks[0].start),e=i(this.tasks[0].end);return this.tasks.forEach((function(n){t=i.min(i(t),i(n.start)),e=i.max(i(e),i(n.end))})),[t,e]},t.prototype.setupDate=function(){var t;t=this.getMinMaxDate(),this.ganttStart=t[0],this.ganttEnd=t[1]},Object.defineProperty(t.prototype,"diffMonth",{get:function(){return this.ganttEnd.diff(this.ganttStart,"month")},enumerable:!1,configurable:!0}),t.prototype.convertToCell=function(){var t=this;this.datas=this.tasks.map((function(e,n){return t.doConvert(e,n)}))},t.prototype.doConvert=function(t,e){var n=(i(t.start).month()-this.ganttStart.month())*this.getRenderColumnWidth(),r=this.headerHeight+this.rowHeight*e+this.options.padding/2,o=this.getRenderColumnWidth()*this.getSplitNumber(t),s=this.options.barHeight;return{id:t.id,value:t.value,x:n,y:r,width:o,height:s}},t.prototype.getSplitNumber=function(t){return i(t.end).diff(i(t.start),"month")+1},t.prototype.getRenderColumnWidth=function(){return this.options.viewMode?4*this.options.columnWidth:this.options.columnWidth},Object.defineProperty(t.prototype,"headerHeight",{get:function(){return this.options.headerHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowHeight",{get:function(){return this.options.barHeight+this.options.padding},enumerable:!1,configurable:!0}),t}(),u=function(t,e,n,r){this.x=t,this.y=e,this.width=n,this.height=r},h=function(){function t(){this.eventListeners=[]}return t.prototype.addListener=function(t,e){null==this.eventListeners&&(this.eventListeners=[]),this.eventListeners.push(t),this.eventListeners.push(e)},t.prototype.removeListener=function(t){if(null!=this.eventListeners)for(var e=0;e<this.eventListeners.length;)this.eventListeners[e+1]==t?this.eventListeners.splice(e,2):e+=2},t.prototype.fireEvent=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(null!=this.eventListeners)for(var r=0;r<this.eventListeners.length;r+=2){var i=this.eventListeners[r];null!==i&&i!==t||this.eventListeners[r+1].apply(this,e)}},t}(),c=function(t){function n(e){var n=t.call(this)||this;return n.gantt=e,n}return e(n,t),n}(h),d=function(t){function n(e){var n=t.call(this)||this;return n.gantt=e,n}return e(n,t),n}(h),l=function(){function t(t){this.root=t}return t.prototype.rect=function(t,e,n,r,i,o,s){var a=this.createElement("rect");o&&(r-=o,e+=o/2),s&&(n-=s,t+=s/2),a.setAttribute("x","".concat(t)),a.setAttribute("y","".concat(e)),a.setAttribute("width","".concat(n)),a.setAttribute("height","".concat(r)),i&&a.setAttribute("rx","".concat(i)),this.node=a},t.prototype.ellipse=function(t,e,n,r){var i=this.createElement("ellipse");i.setAttribute("cx","".concat(t+n/2)),i.setAttribute("cy","".concat(e+r/2)),i.setAttribute("rx","".concat(n/2)),i.setAttribute("ry","".concat(r/2)),this.node=i},t.prototype.end=function(){this.addNode()},t.prototype.addNode=function(){this.root.appendChild(this.node)},t.prototype.createElement=function(t){return this.root.ownerDocument.createElement(t)},t}(),p=function(){function t(){this.initStyles()}return t.prototype.initStyles=function(){this.strokewidth=1,this.opacity=100},t.prototype.init=function(t){this.node=this.create(t),t&&t.appendChild(this.node)},t.prototype.create=function(t){return this.createSvg()},t.prototype.createSvg=function(){return document.createElementNS("http://www.w3.org/2000/svg","g")},t.prototype.redraw=function(){var t=this.createCanvas();this.doRedrawShape(t,this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),this.node.insertAdjacentHTML("beforeend",t.root.outerHTML)},t.prototype.doRedrawShape=function(t,e,n,r,i){t.rect(e,n,r,i,4,4,20),t.end()},t.prototype.createCanvas=function(){return new l(this.node)},t.prototype.apply=function(t){this.state=t},t.prototype.destroy=function(){},t}(),f=function(){function t(){this.defaultShapes=new Map,this.defaultShape=p}return t.prototype.redraw=function(t){this.redrawShape(t)},t.prototype.redrawShape=function(t){t.shape&&(t.shape.destroy(),t.shape=null),null===t.shape&&(t.shape=this.createShape(t),this.initializeShape(t),t.shape.apply(t),t.shape.bounds=new u(t.x,t.y,t.width,t.height),this.doRedrawShape(t))},t.prototype.initializeShape=function(t){var e;null===(e=t.shape)||void 0===e||e.init(t.view.getDrawPane())},t.prototype.doRedrawShape=function(t){var e;null===(e=t.shape)||void 0===e||e.redraw()},t.prototype.createShape=function(t){return new(this.getShapeConstructor(t))},t.prototype.registerShape=function(t,e){this.defaultShapes.set(t,e)},t.prototype.getShapeConstructor=function(t){var e=this.getShape("");return e||this.defaultShape},t.prototype.getShape=function(t){return t?this.defaultShapes.get(t):null},t}(),g=function(){function t(t){this.gantt=t,this.gantt.addMouseListener(this)}return t.prototype.mouseDown=function(){console.log("here run mousedown")},t.prototype.mouseMove=function(){},t.prototype.mouseUp=function(){},t}();var y;!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}(".gantt .headerBackground {\n  fill: #ffffff;\n}\n\n.gantt .bodyRow {\n  fill: #f5f5f5\n}\n\n.gantt .bodyRow:nth-child(even) {\n  fill: #ffffff;\n}\n\n.gantt .row-line {\n  stroke: #ebeff2;\n}\n\n.gantt .bar {\n  fill: #1677ff;\n}\n\n.gantt .barText {\n  dominant-baseline: central;\n  fill: #555;\n}\n"),function(t){t.CLICK="click",t.MOUSEDOWN="mousedown",t.MOUSEMOVE="mousemove",t.MOUSEUP="mouseup",t.CHANGE="change"}(y||(y={}));var v=y,m=function(t,e){this.shape=null,this.invalid=!1,this.view=t,this.cell=e};function w(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg",t);for(var r in e){if("append_to"===r)e.append_to.appendChild(n);else"innerHTML"===r?n.innerHTML=e.innerHTML:n.setAttribute(r,e[r])}return n}var b,S,M=function(t){function n(e,n,r,i,o){var s=t.call(this)||this;return s.gantt=e,s.mode=n,s.columnNum=r,s.columnWidth=i,s.headerHeight=o,s}return e(n,t),n.prototype.init=function(t){this.container=t,this.createSvg(),this.renderTable()},n.prototype.createSvg=function(){var t=this.createGElement();this.tableHeaderPanel=this.createGElement(),this.tableHeaderPanel.classList.add("tableHeaderPanel"),t.appendChild(this.tableHeaderPanel),this.tableBodyPanel=this.createGElement(),this.tableBodyPanel.classList.add("tableBodyPanel"),t.appendChild(this.tableBodyPanel),this.tableBorderPanel=this.createGElement(),this.tableBorderPanel.classList.add("tableBorderPanel"),t.appendChild(this.tableBorderPanel),this.container.appendChild(t)},n.prototype.renderTable=function(){this.redrawTableHeader(),this.redrawTableBody(),this.redrawTableBorder(),this.updateGanttBounds()},n.prototype.updateGanttBounds=function(){this.gantt.view.ganttBounds=new u(0,0,this.getTableWidth(),this.getTableHeight())},n.prototype.redrawTableHeader=function(){w("rect",{x:0,y:0,width:this.getTableWidth(),height:this.headerHeight,class:"headerBackground",append_to:this.tableHeaderPanel});for(var t=0;t<=this.columnNum;t++){console.log(this.gantt.ganttStart.month());var e=this.gantt.ganttStart.add(t,"month").month()+1;console.log(e),w("text",{x:t*this.getRenderColumnWidth(),y:30,innerHTML:e,append_to:this.tableHeaderPanel})}},Object.defineProperty(n.prototype,"rowHeight",{get:function(){return this.gantt.options.barHeight+this.gantt.options.padding},enumerable:!1,configurable:!0}),n.prototype.redrawTableBody=function(){var t=this;this.gantt.tasks.forEach((function(e,n){w("rect",{x:0,y:n*t.rowHeight+t.headerHeight,width:t.getTableWidth(),height:t.rowHeight,class:"bodyRow",append_to:t.tableBodyPanel}),t.rowHeight}))},n.prototype.redrawTableBorder=function(){for(var t=0;t<=this.columnNum;t++)w("line",{x1:this.getRenderColumnWidth()*t,y1:this.headerHeight,x2:this.getRenderColumnWidth()*t,y2:this.headerHeight+this.rowHeight*this.gantt.tasks.length,class:"row-line",append_to:this.tableBorderPanel})},n.prototype.createGElement=function(){return document.createElementNS("http://www.w3.org/2000/svg","g")},n.prototype.getTableWidth=function(){return this.columnNum*this.getRenderColumnWidth()},n.prototype.getTableHeight=function(){return this.headerHeight+this.rowHeight*this.gantt.tasks.length},n.prototype.getRenderColumnWidth=function(){return this.mode?4*this.columnWidth:this.columnWidth},n}(h),E=function(t){function n(e){var n=t.call(this)||this;return n.gantt=e,n.states=new Map,n}return e(n,t),n.prototype.init=function(){this.installListener(),this.createSvg()},n.prototype.installListener=function(){var t=this.gantt.container,e=this.gantt;t.addEventListener(v.MOUSEDOWN,(function(t){e.fireMouseEvent(v.MOUSEDOWN)})),t.addEventListener(v.MOUSEMOVE,(function(t){e.fireMouseEvent(v.MOUSEMOVE)})),t.addEventListener(v.MOUSEUP,(function(t){e.fireMouseEvent(v.MOUSEUP)}))},n.prototype.createGElement=function(){return document.createElementNS("http://www.w3.org/2000/svg","g")},n.prototype.createSvg=function(){var t=this.gantt.container,e=this.canvas=document.createElementNS("http://www.w3.org/2000/svg","g");e.classList.add("canvas"),new M(this.gantt,this.gantt.options.viewMode,this.gantt.diffMonth+1,this.gantt.options.columnWidth,this.gantt.options.headerHeight).init(e),this.drawPane=this.createGElement(),this.drawPane.classList.add("drawPane"),e.appendChild(this.drawPane);var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.style.left="0px",n.style.top="0px",n.style.width="100%",n.style.height="100%",n.style.display="block",n.classList.add("gantt"),n.appendChild(this.canvas),null!=t&&t.appendChild(n)},n.prototype.getState=function(t){var e=null;return t&&((e=this.states.get(t))||(e=this.createState(t),this.states.set(t,e))),e},n.prototype.createState=function(t){return new m(this,t)},n.prototype.invalidate=function(t){var e=this.getState(t);e&&(e.invalid=!0)},n.prototype.validate=function(){var t=this;this.gantt.model.cells.forEach((function(e){var n=t.getState(e);(null==n?void 0:n.invalid)&&(n.invalid=!1,t.updateCellState(n),t.gantt.barRenderer.redraw(n))}))},n.prototype.updateCellState=function(t){var e=this.gantt.getCellGeometry(t.cell);null!==e&&(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height)},n.prototype.getDrawPane=function(){return this.drawPane},n}(h),$=function(){function t(t){this.source=t,this.changes=[]}return t.prototype.add=function(t){this.changes.push(t)},t.prototype.notify=function(){},t.prototype.isEmpty=function(){return 0===this.changes.length},t}(),H=function(){function t(t,e){this.model=t,this.cell=e}return t.prototype.execute=function(){},t}(),O=function(t){function n(){var e=t.call(this)||this;return e.updateLevel=0,e.endingUpdate=!1,e.cells=[],e.currentEdit=e.createUndoableEdit(),e}return e(n,t),n.prototype.add=function(t){this.cells.push(t),this.execute(new H(this,t))},n.prototype.execute=function(t){t.execute(),this.beginUpdate(),this.currentEdit.add(t),this.endUpdate()},n.prototype.createUndoableEdit=function(){var t=new $(this);return t.notify=function(){t.source.fireEvent(v.CHANGE,t.changes)},t},n.prototype.beginUpdate=function(){this.updateLevel++},n.prototype.endUpdate=function(){if(this.updateLevel--,!this.endingUpdate){this.endingUpdate=0===this.updateLevel;try{if(this.endingUpdate&&!this.currentEdit.isEmpty()){var t=this.currentEdit;this.currentEdit=this.createUndoableEdit(),t.notify()}}finally{this.endingUpdate=!1}}},n.prototype.getGeometry=function(t){return t?t.getGeometry():null},n}(h),C=function(){function t(t,e,n){this.value=t,this.geometry=e,this.style=n}return t.prototype.getGeometry=function(){return this.geometry},t.prototype.setGeometry=function(t){this.geometry=t},t}();!function(t){t.DAY="Day",t.WEEK="Week",t.MONTH="Month",t.YEAR="Year"}(S||(S={}));var D=((b={})[S.DAY]="day",b[S.WEEK]="week",b[S.MONTH]="month",b[S.YEAR]="year",b),L=function(t){function n(e,n,r){var i=t.call(this)||this;return i.mouseListeners=[],i.tasks=n,i.options=r,i.container=e,i.setupOptions(),i.barRenderer=i.createBarRenderer(),i.createHandlers(),i.model=new O,i.view=i.createGanttView(),i.model.addListener(v.CHANGE,(function(t){t.forEach(i.processChange.bind(i)),i.view.validate()})),i.codeToGantt=new a(i,i.tasks,i.options),e&&i.init(e),i.sizeDidChange(),i.autoCreateCell(),i}return e(n,t),n.prototype.sizeDidChange=function(){var t=this.view.ganttBounds,e=this.view.getDrawPane().ownerSVGElement;e&&(e.style.minWidth="".concat(t.width,"px"),e.style.minHeight="".concat(t.height,"px"))},n.prototype.insertBar=function(t,e,n,r,i,o){var s=new C(e,new u(n,r,i,o),{});s.id=t,this.addCell(s)},n.prototype.autoCreateCell=function(){var t=this;this.codeToGantt.datas.forEach((function(e){t.insertBar(e.id,e.value,e.x,e.y,e.width,e.height)}))},n.prototype.processChange=function(t){t instanceof H&&this.view.invalidate(t.cell)},n.prototype.createGanttView=function(){return new E(this)},n.prototype.init=function(t){this.view.init()},n.prototype.addCell=function(t){this.addCells([t])},n.prototype.addCells=function(t){var e=this;t.forEach((function(t){e.model.add(t)}))},n.prototype.addMouseListener=function(t){this.mouseListeners.push(t)},n.prototype.fireMouseEvent=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<this.mouseListeners.length;r++){var i=this.mouseListeners[r];t===v.MOUSEDOWN?i.mouseDown.apply(this,e):t===v.MOUSEMOVE?i.mouseMove.apply(this,e):t===v.MOUSEUP&&i.mouseUp.apply(this,e)}t===v.MOUSEUP&&this.click()},n.prototype.click=function(){console.log("here run click")},n.prototype.getCellGeometry=function(t){return this.model.getGeometry(t)},n.prototype.addBar=function(){},n.prototype.createBarRenderer=function(){return new f},n.prototype.createHandlers=function(){this.createBarHandler(),this.createPopupHandler(),this.ganttHandler=this.createGanttHandler()},n.prototype.createGanttHandler=function(){return new g(this)},n.prototype.createBarHandler=function(){return new c(this)},n.prototype.createPopupHandler=function(){return new d(this)},n.prototype.getSplitNumber=function(t){return dayjs(t.end).diff(dayjs(t.start),D[this.options.viewMode])+1},n.prototype.createGElement=function(){return document.createElementNS("http://www.w3.org/2000/svg","g")},n.prototype.setupOptions=function(){var t={headerHeight:50,columnWidth:30,step:24,viewMode:S.DAY,barHeight:30,padding:18};this.options=Object.assign({},t,this.options)},n.prototype.getRenderColumnWidth=function(){return this.options.viewMode?4*this.options.columnWidth:this.options.columnWidth},n.prototype.getTableWidth=function(){return this.diffMonth*this.getRenderColumnWidth()},Object.defineProperty(n.prototype,"ganttStart",{get:function(){return this.codeToGantt.ganttStart},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ganttEnd",{get:function(){return this.codeToGantt.ganttEnd},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"diffMonth",{get:function(){return this.codeToGantt.diffMonth},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowHeight",{get:function(){return this.options.barHeight+this.options.padding},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){},n}(h);return L}));
